# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –Ø–Ω–¥–µ–∫—Å Pay

## –í–∞—à —Ç–µ–∫—É—â–∏–π `.env` —Ñ–∞–π–ª

–°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ø–Ω–¥–µ–∫—Å Pay, –≤ **—Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ** API-–∫–ª—é—á –∏–¥–µ–Ω—Ç–∏—á–µ–Ω Merchant ID. –í–∞—à —Ç–µ–∫—É—â–∏–π `.env` —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ:

```env
YANDEX_MERCHANT_ID=d1c40178-a7be-40c2-add3-700b699f09cb
YANDEX_PAY_API_KEY=d1c40178-a7be-40c2-add3-700b699f09cb
NEXT_PUBLIC_YANDEX_MERCHANT_ID=d1c40178-a7be-40c2-add3-700b699f09cb
YANDEX_PAY_ENV=test
```

‚úÖ **–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã!**

## –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

### –î–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã (—Ç–µ–∫—É—â–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞):

1. **`YANDEX_MERCHANT_ID`** –∏–ª–∏ **`YANDEX_PAY_MERCHANT_ID`**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: `d1c40178-a7be-40c2-add3-700b699f09cb`
   - –≠—Ç–æ –≤–∞—à Merchant ID –º–∞–≥–∞–∑–∏–Ω–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π

2. **`YANDEX_PAY_API_KEY`**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: `d1c40178-a7be-40c2-add3-700b699f09cb` (—Ç–∞–∫–æ–π –∂–µ –∫–∞–∫ Merchant ID)
   - ‚úÖ **–í —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ API-–∫–ª—é—á = Merchant ID** (—Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏ webhook

3. **`NEXT_PUBLIC_YANDEX_MERCHANT_ID`**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: `d1c40178-a7be-40c2-add3-700b699f09cb`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏ (Web SDK)
   - –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–ø–æ—ç—Ç–æ–º—É `NEXT_PUBLIC_`)

4. **`YANDEX_PAY_ENV`**
   - –ó–Ω–∞—á–µ–Ω–∏–µ: `test`
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞

### –î–ª—è –±–æ–µ–≤–æ–π —Å—Ä–µ–¥—ã (production):

–ö–æ–≥–¥–∞ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ production, –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç:

1. **–í—ã–ø—É—Å—Ç–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π API-–∫–ª—é—á** –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–í—ã–ø—É—Å—Ç–∏—Ç—å –∫–ª—é—á Merchant API**
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π API-–∫–ª—é—á (–æ–Ω –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç Merchant ID)

2. **–û–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
   ```env
   YANDEX_MERCHANT_ID=d1c40178-a7be-40c2-add3-700b699f09cb  # –û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ—Ç –∂–µ
   YANDEX_PAY_API_KEY=–Ω–æ–≤—ã–π_api_–∫–ª—é—á_–∏–∑_–ª–∏—á–Ω–æ–≥–æ_–∫–∞–±–∏–Ω–µ—Ç–∞  # –ù–æ–≤—ã–π –∫–ª—é—á!
   NEXT_PUBLIC_YANDEX_MERCHANT_ID=d1c40178-a7be-40c2-add3-700b699f09cb  # –û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ—Ç –∂–µ
   YANDEX_PAY_ENV=production  # –ú–µ–Ω—è–µ–º –Ω–∞ production
   ```

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–ö–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–∞–∑–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞–∑–≤–∞–Ω–∏–π:

‚úÖ `YANDEX_MERCHANT_ID` –∏–ª–∏ `YANDEX_PAY_MERCHANT_ID`  
‚úÖ `YANDEX_PAY_API_KEY` –∏–ª–∏ `YANDEX_API_KEY`  
‚úÖ `NEXT_PUBLIC_YANDEX_MERCHANT_ID` –∏–ª–∏ `NEXT_PUBLIC_YANDEX_PAY_MERCHANT_ID`

–í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å!

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Callback URL

–°–æ–≥–ª–∞—Å–Ω–æ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://pay.yandex.ru/docs/ru/console/settings-pay-split#callback-settings):

1. **–í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ** –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–î–æ–±–∞–≤–∏—Ç—å Callback URL**
2. **–£–∫–∞–∂–∏—Ç–µ URL –ë–ï–ó `/v1/webhook`** ‚Äî –ø—É—Ç—å –¥–æ–±–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

   ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
   ```
   https://www.arteeeco.ru
   ```
   –Ø–Ω–¥–µ–∫—Å Pay –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞: `https://www.arteeeco.ru/v1/webhook`

   ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:
   ```
   https://www.arteeeco.ru/v1/webhook
   ```
   –Ø–Ω–¥–µ–∫—Å Pay –æ—Ç–ø—Ä–∞–≤–∏—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞: `https://www.arteeeco.ru/v1/webhook/v1/webhook` (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!)

3. **–î–ª—è –Ω–∞—à–µ–≥–æ —Å–ª—É—á–∞—è:**
   - –ù–∞—à callback —Ä–æ—É—Ç: `/api/payments/yandex/callback`
   - –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ —É–∫–∞–∂–∏—Ç–µ: `https://www.arteeeco.ru/api/payments/yandex`
   - –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ: `https://www.arteeeco.ru` (–µ—Å–ª–∏ –Ø–Ω–¥–µ–∫—Å Pay –¥–æ–±–∞–≤–∏—Ç `/v1/webhook`, —ç—Ç–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç)

   ‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –Ø–Ω–¥–µ–∫—Å Pay –¥–æ–±–∞–≤–ª—è–µ—Ç `/v1/webhook` –∫ –≤–∞—à–µ–º—É URL. 
   –ù–æ –Ω–∞—à —Ä–æ—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏ `/api/payments/yandex/callback`, –∞ –Ω–µ `/v1/webhook`.
   
   **–†–µ—à–µ–Ω–∏–µ:** –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ —É–∫–∞–∂–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å:
   ```
   https://www.arteeeco.ru/api/payments/yandex/callback
   ```
   
   –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –º–æ–∂–Ω–æ –ª–∏ —É–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—É—Ç—å.

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫

1. ‚úÖ Merchant ID —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. ‚úÖ API-–∫–ª—é—á –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ = Merchant ID (–ø—Ä–∞–≤–∏–ª—å–Ω–æ!)
3. ‚úÖ `YANDEX_PAY_ENV=test` –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã
4. ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Callback URL –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –í–∞—à `.env` —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã
2. ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Callback URL –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –Ø–Ω–¥–µ–∫—Å Pay
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
4. üìù –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ production –∏ –≤—ã–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π API-–∫–ª—é—á

## –°—Å—ã–ª–∫–∏

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º](https://pay.yandex.ru/docs/ru/console/settings-pay-split#callback-settings)
- [Merchant API](https://pay.yandex.ru/docs/ru/custom/backend/merchant-api/)

