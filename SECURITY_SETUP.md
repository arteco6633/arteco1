# Настройка безопасности

## Критические переменные окружения

После внедрения исправлений безопасности необходимо установить следующие переменные окружения в Vercel:

### Обязательные переменные:

1. **ADMIN_LOGIN** - Логин для админ-панели
   - Пример: `arteco`

2. **ADMIN_PASSWORD** - Пароль для админ-панели
   - Пример: `ваш_безопасный_пароль`
   - ⚠️ Используйте сложный пароль!

### Опциональные (для rate limiting):

3. **UPSTASH_REDIS_REST_URL** - URL для Upstash Redis (для rate limiting)
   - Можно получить на https://upstash.com
   - Без этого rate limiting будет работать в памяти (только для одного инстанса)

4. **UPSTASH_REDIS_REST_TOKEN** - Токен для Upstash Redis
   - Получается вместе с URL на https://upstash.com

## Как установить переменные в Vercel:

1. Перейдите в настройки проекта на Vercel
2. Откройте раздел "Environment Variables"
3. Добавьте переменные:
   - `ADMIN_LOGIN` = ваш логин
   - `ADMIN_PASSWORD` = ваш пароль
   - `UPSTASH_REDIS_REST_URL` = (опционально)
   - `UPSTASH_REDIS_REST_TOKEN` = (опционально)
4. Выберите окружения: Production, Preview, Development
5. Сохраните и перезапустите деплой

## Что было исправлено:

✅ Убраны хардкод пароли и токены
✅ Добавлены security headers (CSP, HSTS, Referrer-Policy)
✅ Убраны console.log с чувствительными данными
✅ Включен secure: true для cookies
✅ Добавлена санитизация HTML (DOMPurify)
✅ Добавлен rate limiting на API роуты
✅ Исправлено удаление старых фото при обновлении

## Важно:

- После установки переменных окружения старые хардкод значения больше не работают
- Убедитесь, что установили переменные перед деплоем
- Rate limiting работает без Redis, но лучше использовать Upstash для продакшена


